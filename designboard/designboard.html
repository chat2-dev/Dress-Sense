<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Board</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .active-tool {
            border: 2px solid #000;
        }
        #popup-form {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }
        #popup-form select, #popup-form button {
            display: block;
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
        }
        #selected-garment {
            margin-top: 10px;
            font-weight: bold;
        }
        #selected-component {
            margin-top: 5px;
        }
        #toolbar button {
            margin: 5px;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #toolbar button:hover {
            background-color: #ddd;
        }
        #toolbar select {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Design Board</h1>
    </header>
    <main>
        <div id="popup-form">
            <h2>Select Garment and Component</h2>
            <label for="garment-type">Garment Type:</label>
            <select id="garment-type">
                <option value="shirt">Shirt</option>
                <option value="frock">Frock</option>
                <option value="jeans">Jeans</option>
            </select>
            <label for="component-type">Component Type:</label>
            <select id="component-type">
                <option value="collar">Collar</option>
                <option value="sleeves">Sleeves</option>
                <option value="cuffs">Cuffs</option>
                <option value="hemline">Hemline</option>
                <option value="placket">Placket</option>
            </select>
            <label for="sleeves-type" style="display: none;">Sleeves Type:</label>
            <select id="sleeves-type" style="display: none;">
                <option value="raglan">Raglan</option>
                <option value="bishop">Bishop</option>
                <!-- Add other sleeve types here -->
            </select>
            <button id="start-design">Start Designing</button>
        </div>
        <button id="start-designing">Start Designing</button>
        <p>Let your creativity flow! Start designing your garment now.</p>
        <div id="toolbar" style="display: none;">
            <button id="pencil-tool">Pencil</button>
            <button id="rectangle-tool">Rectangle</button>
            <button id="circle-tool">Circle</button>
            <button id="eraser-tool">Eraser</button>
            <button id="line-tool">Line</button>
            <button id="text-tool">Text</button>
            <button id="color-picker">Color Picker</button>
            <button id="save-design">Save Design</button>
            <button id="download-design">Download Design</button>
            <select id="design-selector">
                <option value="">Select a Design</option>
            </select>
            <div id="selected-garment"></div>
            <div id="selected-component"></div>
        </div>
        <div id="design-board" style="display: none;">
            <canvas id="design-canvas" width="800" height="600"></canvas>
        </div>
    </main>
    <footer>
        <p>&copy; 2024 Dress Sense | All rights reserved</p>
    </footer>
    <script src="script.js"></script>
    <script>
        const canvas = document.getElementById('design-canvas');
        const ctx = canvas.getContext('2d');
        const tools = document.querySelectorAll('#toolbar button');

        let drawing = false;
        let currentTool = 'pencil';
        let startX, startY;

        function startDrawing(event) {
            drawing = true;
            [startX, startY] = getCoordinates(event);
            if (currentTool !== 'pencil' && currentTool !== 'eraser-tool') {
                ctx.beginPath();
            }
            draw(event);
        }

        function endDrawing() {
            drawing = false;
            ctx.beginPath();
        }

        function draw(event) {
            if (!drawing) return;

            const [x, y] = getCoordinates(event);

            switch (currentTool) {
                case 'pencil-tool':
                    drawPencil(x, y);
                    break;
                case 'eraser-tool':
                    erase(x, y);
                    break;
                case 'rectangle-tool':
                    drawRectangle(x, y);
                    break;
                case 'circle-tool':
                    drawCircle(x, y);
                    break;
                case 'line-tool':
                    drawLine(x, y);
                    break;
                case 'text-tool':
                    drawText(x, y);
                    break;
                case 'color-picker':
                    pickColor(x, y);
                    break;
            }
        }

        function getCoordinates(event) {
            let x, y;
            if (event.type.includes('touch')) {
                x = event.touches[0].clientX - canvas.offsetLeft;
                y = event.touches[0].clientY - canvas.offsetTop;
            } else {
                x = event.clientX - canvas.offsetLeft;
                y = event.clientY - canvas.offsetTop;
            }
            return [x, y];
        }

        function drawPencil(x, y) {
            ctx.lineWidth = 5;
            ctx.lineCap = 'round';
            ctx.globalCompositeOperation = 'source-over';
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function erase(x, y) {
            ctx.globalCompositeOperation = 'destination-out';
            ctx.lineWidth = 10; // Eraser size
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function drawRectangle(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeRect(startX, startY, x - startX, y - startY);
        }

        function drawCircle(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2));
            ctx.arc(startX, startY, radius, 0, 2 * Math.PI);
            ctx.stroke();
        }

        function drawLine(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function drawText(x, y) {
            const text = prompt('Enter text:');
            if (text) {
                ctx.font = '20px Arial';
                ctx.fillText(text, x, y);
            }
        }

        function pickColor(x, y) {
            const pixel = ctx.getImageData(x, y, 1, 1).data;
            const color = `rgb(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`;
            alert(`Picked color: ${color}`);
        }

        function selectTool(event) {
            tools.forEach(tool => tool.classList.remove('active-tool'));
            event.target.classList.add('active-tool');
            currentTool = event.target.id;
        }

        tools.forEach(tool => tool.addEventListener('click', selectTool));

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', endDrawing);
        canvas.addEventListener('mousemove', draw);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchend', endDrawing);
        canvas.addEventListener('touchmove', draw);

        async function loadDesigns() {
            const response = await fetch('designs.json');
            const designs = await response.json();
            const designSelector = document.getElementById('design-selector');

            designs.forEach(design => {
                const option = document.createElement('option');
                option.value = design.id;
                option.textContent = design.name;
                designSelector.appendChild(option);
            });

            designSelector.addEventListener('change', (event) => {
                const selectedDesign = designs.find(design => design.id === event.target.value);
                if (selectedDesign) {
                    loadDesignOntoCanvas(selectedDesign);
                }
            });
        }

        function loadDesignOntoCanvas(design) {
            const img = new Image();
            img.src = design.image;
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            };
        }

        loadDesigns();

        document.addEventListener("DOMContentLoaded", function () {
            const popupForm = document.getElementById('popup-form');
            const startDesignButton = document.getElementById('start-design');
            const toolbar = document.getElementById('toolbar');
            const designBoard = document.getElementById('design-board');
            const garmentTypeSelect = document.getElementById('garment-type');
            const garmentComponentSelect = document.getElementById('garment-component');
            const componentTypeSelect = document.getElementById('component-type');
            const sleevesTypeLabel = document.getElementById('sleeves-type').previousElementSibling;
            const sleevesTypeSelect = document.getElementById('sleeves-type');

            const garmentComponents = {
                shirt: ['Sleeve', 'Collar', 'Body'],
                frock: ['Sleeve', 'Neck', 'Body'],
                jeans: ['Waist', 'Leg', 'Pocket']
            };

            const componentTypes = {
                collar: ['Mandarin', 'Spread', 'Peter Pan', 'Wingtip', 'Club', 'Notched'],
                sleeves: ['Raglan', 'Bishop', 'Bell', 'Cap', 'Dolman', 'Flutter', 'Puff'],
                cuffs: ['Barrel', 'French', 'Buttoned', 'Turnback', 'Ribbed'],
                hemline: ['Straight', 'Curved', 'High-Low', 'Asymmetrical'],
                placket: ['Concealed', 'Standard', 'Full-Front']
            };

            function populateComponents(garmentType) {
                garmentComponentSelect.innerHTML = '';
                garmentComponents[garmentType].forEach(component => {
                    const option = document.createElement('option');
                    option.value = component.toLowerCase();
                    option.textContent = component;
                    garmentComponentSelect.appendChild(option);
                });
            }

            function populateComponentTypes(component) {
                componentTypeSelect.innerHTML = '';
                componentTypes[component].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type.toLowerCase().replace(' ', '-');
                    option.textContent = type;
                    componentTypeSelect.appendChild(option);
                });
            }

            garmentTypeSelect.addEventListener('change', function () {
                populateComponents(garmentTypeSelect.value);
            });

            garmentComponentSelect.addEventListener('change', function () {
                populateComponentTypes(garmentComponentSelect.value);
                if (garmentComponentSelect.value === 'sleeve') {
                    sleevesTypeLabel.style.display = 'block';
                    sleevesTypeSelect.style.display = 'block';
                } else {
                    sleevesTypeLabel.style.display = 'none';
                    sleevesTypeSelect.style.display = 'none';
                }
            });

            populateComponents(garmentTypeSelect.value); // Initial population
            populateComponentTypes(garmentComponentSelect.value); // Initial population

            popupForm.style.display = 'block';

            startDesignButton.addEventListener('click', function () {
                popupForm.style.display = 'none';
                toolbar.style.display = 'block';
                designBoard.style.display = 'block';

                const selectedGarment = garmentTypeSelect.options[garmentTypeSelect.selectedIndex].text;
                const selectedComponent = garmentComponentSelect.options[garmentComponentSelect.selectedIndex].text;
                const selectedComponentType = componentTypeSelect.options[componentTypeSelect.selectedIndex].text;

                document.getElementById('selected-garment').textContent = `Garment: ${selectedGarment}`;
                document.getElementById('selected-component').textContent = `Component: ${selectedComponent} (${selectedComponentType})`;
            });

            document.getElementById('start-designing').addEventListener('click', function () {
                popupForm.style.display = 'block';
            });
        });
    </script>
</body>
</html>
