<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Board</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .active-tool {
            border: 2px solid #000;
        }
    </style>
</head>
<body>
    <header>
        <h1>Design Board</h1>
    </header>
    <main>
        <div id="toolbar">
            <button id="pencil-tool">Pencil</button>
            <button id="rectangle-tool">Rectangle</button>
            <button id="circle-tool">Circle</button>
            <button id="eraser-tool">Eraser</button>
            <button id="line-tool">Line</button>
            <button id="text-tool">Text</button>
            <button id="color-picker">Color Picker</button>
            <button id="save-design">Save Design</button>
            <button id="download-design">Download Design</button>
            <select id="design-selector">
                <option value="">Select a Design</option>
            </select>
        </div>
        <div id="design-board">
            <canvas id="design-canvas" width="800" height="600"></canvas>
        </div>
    </main>
    <footer>
        <p>&copy; 2024 Dress Sense | All rights reserved</p>
    </footer>
    <script src="script.js"></script>
    <script>
        const canvas = document.getElementById('design-canvas');
        const ctx = canvas.getContext('2d');
        const tools = document.querySelectorAll('#toolbar button');

        let drawing = false;
        let currentTool = 'pencil';
        let startX, startY;

        function startDrawing(event) {
            drawing = true;
            [startX, startY] = getCoordinates(event);
            if (currentTool !== 'pencil' && currentTool !== 'eraser-tool') {
                ctx.beginPath();
            }
            draw(event);
        }

        function endDrawing() {
            drawing = false;
            ctx.beginPath();
        }

        function draw(event) {
            if (!drawing) return;

            const [x, y] = getCoordinates(event);

            switch (currentTool) {
                case 'pencil-tool':
                    drawPencil(x, y);
                    break;
                case 'eraser-tool':
                    erase(x, y);
                    break;
                case 'rectangle-tool':
                    drawRectangle(x, y);
                    break;
                case 'circle-tool':
                    drawCircle(x, y);
                    break;
                case 'line-tool':
                    drawLine(x, y);
                    break;
                case 'text-tool':
                    drawText(x, y);
                    break;
                case 'color-picker':
                    pickColor(x, y);
                    break;
            }
        }

        function getCoordinates(event) {
            let x, y;
            if (event.type.includes('touch')) {
                x = event.touches[0].clientX - canvas.offsetLeft;
                y = event.touches[0].clientY - canvas.offsetTop;
            } else {
                x = event.clientX - canvas.offsetLeft;
                y = event.clientY - canvas.offsetTop;
            }
            return [x, y];
        }

        function drawPencil(x, y) {
            ctx.lineWidth = 5;
            ctx.lineCap = 'round';
            ctx.globalCompositeOperation = 'source-over';
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function erase(x, y) {
            ctx.globalCompositeOperation = 'destination-out';
            ctx.lineWidth = 10; // Eraser size
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function drawRectangle(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeRect(startX, startY, x - startX, y - startY);
        }

        function drawCircle(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2));
            ctx.arc(startX, startY, radius, 0, 2 * Math.PI);
            ctx.stroke();
        }

        function drawLine(x, y) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function drawText(x, y) {
            const text = prompt('Enter text:');
            if (text) {
                ctx.font = '20px Arial';
                ctx.fillText(text, x, y);
            }
        }

        function pickColor(x, y) {
            const pixel = ctx.getImageData(x, y, 1, 1).data;
            const color = `rgb(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`;
            alert(`Picked color: ${color}`);
        }

        function selectTool(event) {
            tools.forEach(tool => tool.classList.remove('active-tool'));
            event.target.classList.add('active-tool');
            currentTool = event.target.id;
        }

        tools.forEach(tool => tool.addEventListener('click', selectTool));

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', endDrawing);
        canvas.addEventListener('mousemove', draw);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchend', endDrawing);
        canvas.addEventListener('touchmove', draw);

        async function loadDesigns() {
            const response = await fetch('designs.json');
            const designs = await response.json();
            const designSelector = document.getElementById('design-selector');

            designs.forEach(design => {
                const option = document.createElement('option');
                option.value = design.id;
                option.textContent = design.name;
                designSelector.appendChild(option);
            });

            designSelector.addEventListener('change', (event) => {
                const selectedDesign = designs.find(design => design.id === event.target.value);
                if (selectedDesign) {
                    loadDesignOntoCanvas(selectedDesign);
                }
            });
        }

        function loadDesignOntoCanvas(design) {
            const img = new Image();
            img.src = design.image;
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            };
        }

        loadDesigns();
    </script>
</body>
</html>
